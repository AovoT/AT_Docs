此链接是解决网卡驱动的文章[https://www.bilibili.com/opus/787386858396975105?spm_id_from=333.1007.0.0](https://www.bilibili.com/opus/787386858396975105?spm_id_from=333.1007.0.0)

<font style="background-color:#DF2A3F;">本文针对螃蟹网卡</font>

<h1 id="P1M6u">前言</h1>
安装ubuntu22.04时，会出现没有无线WIFI的情况，针对此事写一篇解答

目前来看，出现问题的多为Realtek（小螃蟹）网卡，要对此安装一些驱动

<h2 id="pWlqd">进入此链接</h2>
[https://github.com/morrownr/rtw89](https://github.com/morrownr/rtw89)



<h1 id="O4Oly">这是他的文档说明</h1>
按照他说的即可安装成功,我也修改了一下

<h2 id="BlHgz"><font style="color:#000000;">本仓库的使命：</font></h2>
<font style="color:#000000;">为 Realtek RTW89 驱动程序系列编写、测试并向上游提交高质量的符合 Linux 标准 (mac80211) 的 USB WiFi 驱动程序。</font>

<h2 id="ph67Q"><font style="color:#000000;">兼容性</font></h2>
<font style="color:#000000;">本驱动程序兼容</font>**<font style="color:#000000;">Linux 内核 6.6 及更高版本</font>**<font style="color:#000000;">，前提是您的发行版没有修改任何内核 API。RHEL 以及所有基于 RHEL 的发行版都已修改了内核 API，因此可能与本驱动程序不兼容。</font>

<h4 id="q8dy6"><font style="color:#000000;">支持的芯片</font></h4>
+ **<font style="color:#000000;">USB</font>**<font style="color:#000000;">：RTL8831BU、RTL8851BU、RTL8832AU、RTL8852AU、RTL8832BU、RTL8852BU</font>
+ **<font style="color:#000000;">USB</font>**<font style="color:#000000;">：RTL8832CU、RTL8852CU、RTL8912AU、RTL8922AU（暂无MLO）</font>
+ **<font style="color:#000000;">PCIe</font>**<font style="color:#000000;">：RTL8851BE、RTL8852AE、RTL8852BE(-VS, -VT)、RTL8852CE、RTL8922AE(-VS)</font>

<font style="color:#000000;">注意：如果您拥有的 USB WiFi 适配器采用上述支持的芯片，且您的适配器是单状态（板载无 Windows 驱动程序）和单功能（不支持蓝牙），请提交一个 issue，并发布您适配器的品牌、名称、芯片型号以及产品链接。这将有助于我们列出推荐的适配器列表。</font>

<h2 id="YZPxv"><font style="color:#000000;">先决条件</font></h2>
```shell
sudo apt update
sudo apt install --install-recommends linux-generic-hwe-22.04
sudo apt install git make gcc dkms -f
sudo reboot
```

<h2 id="HyinD"><font style="color:#000000;">安装指南</font></h2>
1. <font style="color:#000000;background-color:#FFFFFF;">在本地计算机上克隆此仓库。</font>

```plain
git clone https://github.com/morrownr/rtw89
```

2. <font style="color:#000000;">将工作目录更改为 rtw89</font>

```plain
cd rtw89
```

3. <font style="color:#000000;">搜索并移除之前安装的内核外 rtw89 驱动程序。如果您的系统安装了</font>[<font style="color:rgb(68, 147, 248);">Larry 的 rtw89 驱动程序</font>](https://github.com/lwfinger/rtw89)<font style="color:#000000;">，则必须运行此命令将其移除，否则该驱动程序将无法正常工作。</font>

```plain
sudo make cleanup_target_system
```

4. <font style="color:#000000;">构建并安装驱动程序</font>
    - _<font style="color:#000000;">通过 dkms（如果您的系统启用了安全启动，则特别推荐使用此方法）</font>_

```plain
sudo dkms install $PWD
```

    - _<font style="color:#000000;background-color:#FFFFFF;">通过 make 命令</font>_<font style="color:#000000;background-color:#FFFFFF;">（</font>**<font style="color:#000000;background-color:#FFFFFF;">测试 USB 设备新驱动程序的测试人员必须使用此方法安装驱动程序。</font>**<font style="color:#000000;background-color:#FFFFFF;">）</font>

```plain
make clean modules && sudo make install
```

5. <font style="color:#000000;">安装驱动程序所需的固件</font>

```plain
sudo make install_fw
```

6. <font style="color:#000000;">将配置文件复制</font>`<font style="color:#000000;">rtw89.conf</font>`<font style="color:#000000;">到 /etc/modprobe.d/</font>

```plain
sudo cp -v rtw89.conf /etc/modprobe.d/
```

<font style="color:#000000;">注意：上述步骤会将可能与此存储库中的驱动程序冲突的内核驱动程序列入黑名单。</font>

7. <font style="color:#000000;">注册 MOK（机器所有者密钥）。仅当您的系统启用了</font>[<font style="color:#000000;">安全启动</font>](https://wiki.debian.org/SecureBoot)**<font style="color:#000000;">时才</font>**<font style="color:#000000;"> 需要此操作。详情请参阅</font>[<font style="color:#000000;">此指南。</font>](https://github.com/dell/dkms?tab=readme-ov-file#secure-boot)

```plain
sudo mokutil --import /var/lib/dkms/mok.pub
```

<font style="color:#000000;">对于基于 Ubuntu 的发行版用户，请运行此命令。</font>

```plain
sudo mokutil --import /var/lib/shim-signed/mok/MOK.der
```

<h2 id="FAl4M"><font style="color:#000000;">卸载指南</font></h2>
<font style="color:#000000;">对于通过以下命令安装驱动程序的用户</font>`<font style="color:#000000;">DKMS</font>`<font style="color:#000000;">，请运行：</font>

1. <font style="color:#000000;">检查系统上安装的rtw89驱动程序版本。</font>

```plain
sudo dkms status rtw89
```

1. <font style="color:#000000;">移除rtw89驱动程序及其源代码（相应地更改驱动程序版本）</font>

```plain
sudo dkms remove rtw89/6.15 --all
```

```plain
sudo rm -rf /usr/src/rtw89-6.15
```

1. <font style="color:#000000;">删除配置文件</font>

```plain
sudo rm -f /etc/modprobe.d/rtw89.conf
```

<font style="color:#000000;">对于通过 rtw89 源目录安装驱动程序的用户</font>`<font style="color:#000000;">make</font>`<font style="color:#000000;">，请在 rtw89 源目录中运行以下命令。</font>

```plain
sudo make uninstall
```

```plain
sudo rm -f /etc/modprobe.d/rtw89.conf
```

<h2 id="Gev7V"><font style="color:#000000;">问答</font></h2>
<h3 id="xXiT3"><font style="color:#000000;">Q1. 安装此驱动程序后蓝牙仍然无法工作，为什么？</font></h3>
<font style="color:#000000;">该</font>`<font style="color:#000000;">rtw89</font>`<font style="color:#000000;">驱动程序是Realtek Wi-Fi 6/7 适配器的</font>**<font style="color:#000000;">Wi-Fi</font>**<font style="color:#000000;">驱动程序，与蓝牙无关。</font>

<h3 id="ZkwIs"><font style="color:#000000;">Q2. 如何更新通过 DKMS 安装的驱动程序？</font></h3>
1. <font style="color:#000000;">检查系统上安装的rtw89驱动程序版本。</font>

```plain
sudo dkms status rtw89
```

2. <font style="color:#000000;">移除rtw89驱动程序。（请相应地更改驱动程序版本）</font>

```plain
sudo dkms remove rtw89/6.15 --all
```

```plain
sudo rm -rf /usr/src/rtw89-6.15/
```

3. <font style="color:#000000;">在 rtw89 源代码目录中运行此命令以拉取最新代码</font>

```plain
git pull
```

4. <font style="color:#000000;">使用最新代码构建、签名并安装rtw89驱动程序。</font>

```plain
sudo dkms install $PWD
```

<h3 id="f9l6P"><font style="color:#000000;">Q3. 如何更新通过以下方式安装的驱动程序</font>`<font style="color:#000000;">make</font>`<font style="color:#000000;">？</font></h3>
1. <font style="color:#000000;">在 rtw89 源代码目录中运行此命令以拉取最新代码</font>

```plain
git pull
```

2. <font style="color:#000000;">使用最新代码重新构建并重新安装驱动程序</font>

```plain
make clean modules && sudo make install
```

<h3 id="DibJ9"><font style="color:#000000;">Q4. 如何更新系统中的固件？</font></h3>
1. <font style="color:#000000;">在 rtw89 源代码目录中运行此命令，以获取最新的代码和固件。</font>

```plain
git pull
```

2. <font style="color:#000000;">更新系统中的固件文件</font>

```plain
sudo make install_fw
```

<h2 id="w3rmI"><font style="color:#000000;">本网站的主菜单包含大量关于USB WiFi适配器的信息。</font></h2>
[<font style="color:rgb(68, 147, 248);background-color:#FFFFFF;">https://github.com/morrownr/USB-WiFi</font>](https://github.com/morrownr/USB-WiFi)

<h2 id="X4CyH"></h2>




